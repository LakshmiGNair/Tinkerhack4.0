<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Bondify ‚ù§Ô∏è ‚Äî Dashboard</title>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,700;1,400&family=DM+Sans:wght@300;400;500&display=swap" rel="stylesheet"/>
  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

    :root {
      --rose:    #e8647a;
      --blush:   #f9dde2;
      --cream:   #fdf6f0;
      --warm:    #f2c4a0;
      --deep:    #2d1b24;
      --muted:   #9b7b85;
      --card-bg: rgba(255,255,255,0.72);
      --shadow:  0 8px 32px rgba(45,27,36,0.10);
      --radius:  20px;
    }

    body {
      font-family: 'DM Sans', sans-serif;
      background: var(--cream);
      color: var(--deep);
      min-height: 100vh;
      overflow-x: hidden;
    }

    /* ‚îÄ‚îÄ Background blobs ‚îÄ‚îÄ */
    .bg-blobs { position: fixed; inset: 0; z-index: 0; pointer-events: none; }
    .blob {
      position: absolute; border-radius: 50%; filter: blur(80px); opacity: 0.35;
      animation: drift 12s ease-in-out infinite alternate;
    }
    .blob-1 { width: 520px; height: 520px; background: #f7bcc8; top: -120px; left: -80px; }
    .blob-2 { width: 400px; height: 400px; background: #f9d4a0; bottom: -80px; right: -60px; animation-delay: 3s; }
    .blob-3 { width: 300px; height: 300px; background: #c4d9f7; top: 40%; left: 55%; animation-delay: 6s; }
    @keyframes drift {
      from { transform: translate(0,0) scale(1); }
      to   { transform: translate(30px,20px) scale(1.06); }
    }

    /* ‚îÄ‚îÄ Layout ‚îÄ‚îÄ */
    .page { position: relative; z-index: 1; max-width: 1100px; margin: 0 auto; padding: 36px 24px 60px; }

    /* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
       HERO SECTION
    ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
    .hero {
      position: relative;
      border-radius: 28px;
      overflow: hidden;
      margin-bottom: 32px;
      min-height: 230px;
      background: linear-gradient(135deg, #f9dde2 0%, #fde8c8 100%);
      box-shadow: var(--shadow);
      animation: slide-up 0.5s ease both;
      display: flex; align-items: flex-end;
    }

    /* Couple photo background */
    .couple-bg {
      position: absolute; inset: 0;
      background-size: cover; background-position: center;
      opacity: 0; transition: opacity 0.5s;
    }
    .couple-bg.loaded { opacity: 1; }
    .couple-bg::after {
      content: '';
      position: absolute; inset: 0;
      background: linear-gradient(to top, rgba(45,27,36,0.65) 0%, rgba(45,27,36,0.1) 60%, transparent 100%);
    }

    /* Upload couple photo button */
    .couple-upload-btn {
      position: absolute; top: 14px; right: 14px; z-index: 3;
      background: rgba(255,255,255,0.88); backdrop-filter: blur(8px);
      border: none; border-radius: 50px;
      padding: 8px 16px; font-family: 'DM Sans', sans-serif;
      font-size: 0.82rem; color: var(--deep); cursor: pointer;
      display: flex; align-items: center; gap: 6px;
      transition: background 0.2s, transform 0.2s;
      box-shadow: 0 2px 12px rgba(45,27,36,0.12);
    }
    .couple-upload-btn:hover { background: #fff; transform: translateY(-1px); }

    /* Hero bottom content */
    .hero-content {
      position: relative; z-index: 2;
      width: 100%; padding: 24px 28px;
      display: flex; align-items: center; justify-content: space-between;
      flex-wrap: wrap; gap: 16px;
    }

    /* Avatar pair */
    .avatar-pair { display: flex; align-items: center; }

    .avatar-wrap {
      display: flex; flex-direction: column; align-items: center; gap: 6px;
    }
    .avatar-wrap:first-child { margin-right: -10px; z-index: 2; }
    .avatar-wrap:last-child  { margin-left: -10px;  z-index: 1; }

    .avatar {
      width: 76px; height: 76px; border-radius: 50%;
      border: 3px solid rgba(255,255,255,0.9);
      background: var(--blush);
      cursor: pointer;
      transition: transform 0.2s, box-shadow 0.2s;
      display: flex; align-items: center; justify-content: center;
      font-size: 1.9rem;
      overflow: hidden;
      position: relative;
      box-shadow: 0 4px 16px rgba(45,27,36,0.2);
    }
    .avatar:hover { transform: scale(1.08); box-shadow: 0 6px 20px rgba(45,27,36,0.3); }

    .avatar img {
      width: 100%; height: 100%; object-fit: cover;
      position: absolute; inset: 0;
      display: none;
    }

    /* Camera overlay on avatar hover */
    .avatar .cam-hint {
      position: absolute; inset: 0;
      background: rgba(45,27,36,0.45);
      display: flex; align-items: center; justify-content: center;
      font-size: 1.3rem; opacity: 0; transition: opacity 0.2s;
      border-radius: 50%;
    }
    .avatar:hover .cam-hint { opacity: 1; }

    .avatar-name {
      font-size: 0.75rem; font-weight: 500;
      color: #fff; text-shadow: 0 1px 4px rgba(0,0,0,0.45);
      white-space: nowrap;
    }

    .heart-divider {
      font-size: 1.3rem; margin: 0 8px; padding-bottom: 22px;
      filter: drop-shadow(0 2px 4px rgba(0,0,0,0.25));
    }

    /* Hero right */
    .hero-right { text-align: right; }
    .hero-right h1 {
      font-family: 'Playfair Display', serif;
      font-size: clamp(1.4rem, 3.5vw, 2.1rem);
      color: #fff;
      text-shadow: 0 2px 8px rgba(0,0,0,0.3);
      line-height: 1.2;
    }
    .hero-right h1 span { font-style: italic; color: var(--warm); }
    .hero-right p { color: rgba(255,255,255,0.75); font-size: 0.85rem; margin-top: 4px; }

    .streak-pill {
      display: inline-flex; align-items: center; gap: 8px;
      background: rgba(255,255,255,0.15); backdrop-filter: blur(8px);
      border: 1px solid rgba(255,255,255,0.3);
      color: #fff; border-radius: 50px;
      padding: 8px 16px; margin-top: 10px;
      font-size: 0.85rem;
    }
    .streak-pill .flame { animation: flicker 1.4s ease-in-out infinite alternate; display: inline-block; }
    .streak-pill .count { font-family: 'Playfair Display', serif; font-size: 1.3rem; line-height: 1; }
    @keyframes flicker {
      from { transform: scale(1) rotate(-5deg); }
      to   { transform: scale(1.15) rotate(5deg); }
    }

    /* Hidden file inputs */
    #profileInput, #coupleInput { display: none; }

    /* ‚îÄ‚îÄ Mood strip ‚îÄ‚îÄ */
    .mood-strip {
      background: var(--card-bg);
      border: 1px solid rgba(232,100,122,0.15);
      border-radius: var(--radius);
      padding: 20px 24px;
      margin-bottom: 32px;
      backdrop-filter: blur(12px);
      box-shadow: var(--shadow);
      animation: slide-up 0.5s 0.15s ease both;
    }
    .mood-strip h3 { font-family: 'Playfair Display', serif; font-size: 1rem; margin-bottom: 14px; }
    .mood-options { display: flex; gap: 10px; flex-wrap: wrap; }
    .mood-btn {
      border: none; background: var(--blush); border-radius: 50px;
      padding: 8px 18px; cursor: pointer; font-family: 'DM Sans', sans-serif;
      font-size: 0.88rem; color: var(--deep); transition: all 0.2s;
      display: flex; align-items: center; gap: 6px;
    }
    .mood-btn:hover, .mood-btn.active {
      background: var(--rose); color: #fff; transform: translateY(-2px);
      box-shadow: 0 4px 14px rgba(232,100,122,0.35);
    }
    .mood-result { margin-top: 12px; font-size: 0.88rem; color: var(--muted); min-height: 20px; }

    /* ‚îÄ‚îÄ Name strip ‚îÄ‚îÄ */
    .name-strip {
      background: var(--card-bg);
      border: 1px solid rgba(232,100,122,0.15);
      border-radius: var(--radius);
      padding: 20px 24px;
      margin-bottom: 32px;
      backdrop-filter: blur(12px);
      box-shadow: var(--shadow);
      animation: slide-up 0.5s 0.2s ease both;
    }
    .name-strip h3 { font-family: 'Playfair Display', serif; font-size: 1rem; margin-bottom: 16px; }
    .name-fields {
      display: flex; align-items: center; gap: 12px; flex-wrap: wrap;
    }
    .name-field { display: flex; flex-direction: column; gap: 6px; flex: 1; min-width: 160px; }
    .name-field label { font-size: 0.78rem; color: var(--muted); font-weight: 500; text-transform: uppercase; letter-spacing: 0.05em; }
    .name-field input {
      padding: 11px 16px;
      border: 1.5px solid rgba(232,100,122,0.2);
      border-radius: 12px;
      font-family: 'DM Sans', sans-serif;
      font-size: 0.95rem;
      color: var(--deep);
      background: rgba(255,255,255,0.9);
      outline: none;
      transition: border-color 0.2s, box-shadow 0.2s;
    }
    .name-field input::placeholder { color: #c4aab0; }
    .name-field input:focus {
      border-color: var(--rose);
      box-shadow: 0 0 0 4px rgba(232,100,122,0.12);
    }
    .name-heart { font-size: 1.4rem; padding-top: 22px; }

    /* ‚îÄ‚îÄ Feature grid ‚îÄ‚îÄ */
    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
      gap: 20px;
    }
    .card {
      background: var(--card-bg);
      border: 1px solid rgba(232,100,122,0.12);
      border-radius: var(--radius);
      padding: 28px 24px;
      backdrop-filter: blur(12px);
      box-shadow: var(--shadow);
      cursor: pointer;
      transition: transform 0.25s, box-shadow 0.25s;
      animation: slide-up 0.5s ease both;
      position: relative; overflow: hidden;
      display: flex; flex-direction: column; gap: 10px;
    }
    .card::before {
      content: ''; position: absolute; inset: 0;
      background: linear-gradient(135deg, rgba(232,100,122,0.08) 0%, transparent 60%);
      opacity: 0; transition: opacity 0.3s;
    }
    .card:hover { transform: translateY(-5px); box-shadow: 0 16px 48px rgba(45,27,36,0.14); }
    .card:hover::before { opacity: 1; }
    .card:nth-child(1) { animation-delay: 0.2s; }
    .card:nth-child(2) { animation-delay: 0.27s; }
    .card:nth-child(3) { animation-delay: 0.34s; }
    .card:nth-child(4) { animation-delay: 0.41s; }
    .card:nth-child(5) { animation-delay: 0.48s; }

    .card-icon {
      font-size: 2.2rem; width: 56px; height: 56px;
      background: var(--blush); border-radius: 16px;
      display: grid; place-items: center; transition: transform 0.3s;
    }
    .card:hover .card-icon { transform: scale(1.12) rotate(-4deg); }
    .card-title { font-family: 'Playfair Display', serif; font-size: 1.25rem; }
    .card-desc  { font-size: 0.87rem; color: var(--muted); line-height: 1.55; }
    .card-action {
      margin-top: auto;
      display: inline-flex; align-items: center; gap: 6px;
      color: var(--rose); font-size: 0.85rem; font-weight: 500;
    }
    .card-action svg { transition: transform 0.2s; }
    .card:hover .card-action svg { transform: translateX(4px); }
    .card[data-color="video"]     .card-icon { background: #ddf0fb; }
    .card[data-color="questions"] .card-icon { background: #fde8c8; }
    .card[data-color="games"]     .card-icon { background: #d8f5e4; }
    .card[data-color="music"]     .card-icon { background: #ede0fb; }
    .card[data-color="streak"]    .card-icon { background: #fde2e9; }

    /* ‚îÄ‚îÄ Modal ‚îÄ‚îÄ */
    .modal-overlay {
      position: fixed; inset: 0; z-index: 100;
      background: rgba(45,27,36,0.45); backdrop-filter: blur(6px);
      display: flex; align-items: center; justify-content: center;
      padding: 24px; opacity: 0; pointer-events: none; transition: opacity 0.3s;
    }
    .modal-overlay.open { opacity: 1; pointer-events: all; }
    .modal {
      background: #fff; border-radius: 28px;
      padding: 36px 32px; max-width: 480px; width: 100%;
      box-shadow: 0 24px 80px rgba(45,27,36,0.25);
      transform: scale(0.9); transition: transform 0.3s cubic-bezier(.34,1.56,.64,1);
      position: relative;
    }
    .modal-overlay.open .modal { transform: scale(1); }
    .modal h2 { font-family: 'Playfair Display', serif; font-size: 1.5rem; margin-bottom: 10px; }
    .modal p  { color: var(--muted); font-size: 0.9rem; line-height: 1.6; margin-bottom: 20px; }
    .modal-close {
      position: absolute; top: 16px; right: 20px;
      background: none; border: none; font-size: 1.4rem;
      cursor: pointer; color: var(--muted); transition: color 0.2s;
    }
    .modal-close:hover { color: var(--rose); }
    .modal-btn {
      display: inline-block; background: var(--rose); color: #fff;
      border: none; border-radius: 50px; padding: 12px 28px;
      font-family: 'DM Sans', sans-serif; font-size: 0.95rem;
      cursor: pointer; transition: transform 0.2s, box-shadow 0.2s;
    }
    .modal-btn:hover { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(232,100,122,0.4); }
    .q-box {
      background: var(--blush); border-radius: 16px;
      padding: 20px; margin-bottom: 20px;
      font-family: 'Playfair Display', serif; font-size: 1.1rem;
      color: var(--deep); line-height: 1.5; text-align: center;
      transition: opacity 0.25s;
    }
    .streak-dots { display: flex; gap: 6px; margin-top: 14px; flex-wrap: wrap; }
    .dot { width: 10px; height: 10px; border-radius: 50%; background: var(--blush); }
    .dot.filled { background: var(--rose); }
    .game-list { display: flex; flex-direction: column; gap: 10px; margin-bottom: 20px; }
    .game-item {
      display: flex; align-items: center; gap: 12px;
      background: var(--blush); border-radius: 12px; padding: 12px 16px;
      cursor: pointer; transition: background 0.2s; font-size: 0.9rem;
    }
    .game-item:hover { background: var(--warm); }
    .music-player {
      background: var(--deep); border-radius: 16px;
      padding: 20px; color: #fff; text-align: center; margin-bottom: 20px;
    }
    .music-player .song-name { font-family: 'Playfair Display', serif; font-size: 1.1rem; margin-bottom: 4px; }
    .music-player .artist { font-size: 0.8rem; opacity: 0.6; margin-bottom: 16px; }
    .progress-bar { width: 100%; height: 4px; background: rgba(255,255,255,0.2); border-radius: 2px; margin-bottom: 16px; }
    .progress-fill { height: 100%; width: 38%; background: var(--rose); border-radius: 2px; }
    .music-controls { display: flex; justify-content: center; gap: 20px; font-size: 1.5rem; }
    .music-controls span { cursor: pointer; transition: transform 0.2s; }
    .music-controls span:hover { transform: scale(1.2); }

    @keyframes slide-up {
      from { opacity: 0; transform: translateY(24px); }
      to   { opacity: 1; transform: translateY(0); }
    }
  </style>
</head>
<body>

<div class="bg-blobs">
  <div class="blob blob-1"></div>
  <div class="blob blob-2"></div>
  <div class="blob blob-3"></div>
</div>

<div class="page">

  <!-- ‚îÄ‚îÄ HERO ‚îÄ‚îÄ -->
  <div class="hero">
    <div class="couple-bg" id="coupleBg"></div>

    <button class="couple-upload-btn" id="coupleBtn" onclick="document.getElementById('coupleInput').click()">
      üì∑ Add couple photo
    </button>
    <input type="file" id="coupleInput" accept="image/*" onchange="uploadCouplePhoto(event)"/>
    <input type="file" id="profileInput" accept="image/*" onchange="uploadProfilePhoto(event)"/>

    <div class="hero-content">

      <!-- Avatars -->
      <div class="avatar-pair">
        <div class="avatar-wrap">
          <div class="avatar" id="myAvatar" onclick="document.getElementById('profileInput').click()" title="Tap to add your photo">
            <span id="myAvatarEmoji">üßë</span>
            <img id="myAvatarImg" alt="Your photo"/>
            <div class="cam-hint">üì∑</div>
          </div>
          <span class="avatar-name" id="myAvatarName">You</span>
        </div>

        <span class="heart-divider">‚ù§Ô∏è</span>

        <div class="avatar-wrap">
          <div class="avatar" style="background:#fde8c8; cursor:default;">
            <span>üßë</span>
          </div>
          <span class="avatar-name" id="partnerAvatarName">Partner</span>
        </div>
      </div>

      <!-- Name + streak -->
      <div class="hero-right">
        <h1>Hello, <span id="userName">there</span> üå∏</h1>
        <p>& <span id="partnerNameDisplay">your partner</span> are connected üíï</p>
        <div class="streak-pill">
          <span class="flame">üî•</span>
          <span class="count">14</span>
          <span style="opacity:0.8; font-size:0.78rem;">day streak</span>
        </div>
      </div>

    </div>
  </div>

  <!-- ‚îÄ‚îÄ MOOD ‚îÄ‚îÄ -->
  <div class="mood-strip">
    <h3>How are you feeling today?</h3>
    <div class="mood-options">
      <button class="mood-btn" onclick="setMood(this,'Happy')">üòä Happy</button>
      <button class="mood-btn" onclick="setMood(this,'Loved up')">ü•∞ Loved up</button>
      <button class="mood-btn" onclick="setMood(this,'Missing you')">üòî Missing you</button>
      <button class="mood-btn" onclick="setMood(this,'Stressed')">üò§ Stressed</button>
      <button class="mood-btn" onclick="setMood(this,'Excited')">ü§ó Excited</button>
    </div>
    <div class="mood-result" id="moodResult"></div>
  </div>

  <!-- ‚îÄ‚îÄ NAME INPUTS ‚îÄ‚îÄ -->
  <div class="name-strip">
    <h3>Who's here? üíë</h3>
    <div class="name-fields">
      <div class="name-field">
        <label>Your name</label>
        <input type="text" id="inputUserName" placeholder="e.g. Arjun" oninput="updateNames()"/>
      </div>
      <div class="name-heart">‚ù§Ô∏è</div>
      <div class="name-field">
        <label>Partner's name</label>
        <input type="text" id="inputPartnerName" placeholder="e.g. Priya" oninput="updateNames()"/>
      </div>
    </div>
  </div>

  <!-- ‚îÄ‚îÄ FEATURE CARDS ‚îÄ‚îÄ -->
  <div class="grid">

    <div class="card" data-color="video" onclick="openModal('video')">
      <div class="card-icon">üìπ</div>
      <div class="card-title">Video Call</div>
      <div class="card-desc">Jump into a face-to-face moment. See each other, laugh together, and just be present.</div>
      <div class="card-action">Start call <svg width="14" height="14" viewBox="0 0 14 14" fill="none"><path d="M3 7h8M8 4l3 3-3 3" stroke="#e8647a" stroke-width="1.5" stroke-linecap="round"/></svg></div>
    </div>

    <div class="card" data-color="questions" onclick="openModal('questions')">
      <div class="card-icon">üí¨</div>
      <div class="card-title">Question Cards</div>
      <div class="card-desc">Discover each other deeper with fun, thoughtful, and sometimes surprising questions.</div>
      <div class="card-action">Draw a card <svg width="14" height="14" viewBox="0 0 14 14" fill="none"><path d="M3 7h8M8 4l3 3-3 3" stroke="#e8647a" stroke-width="1.5" stroke-linecap="round"/></svg></div>
    </div>

    <div class="card" data-color="games" onclick="openModal('games')">
      <div class="card-icon">üéÆ</div>
      <div class="card-title">Play Together</div>
      <div class="card-desc">Mini-games designed for two. Challenge each other and have fun across the miles.</div>
      <div class="card-action">Browse games <svg width="14" height="14" viewBox="0 0 14 14" fill="none"><path d="M3 7h8M8 4l3 3-3 3" stroke="#e8647a" stroke-width="1.5" stroke-linecap="round"/></svg></div>
    </div>

    <div class="card" data-color="music" onclick="openModal('music')">
      <div class="card-icon">üéµ</div>
      <div class="card-title">Sync Music</div>
      <div class="card-desc">Listen to the same song at the same time. Build your couple's playlist together.</div>
      <div class="card-action">Open player <svg width="14" height="14" viewBox="0 0 14 14" fill="none"><path d="M3 7h8M8 4l3 3-3 3" stroke="#e8647a" stroke-width="1.5" stroke-linecap="round"/></svg></div>
    </div>

    <div class="card" data-color="streak" onclick="openModal('streak')">
      <div class="card-icon">üìÖ</div>
      <div class="card-title">Your Streak</div>
      <div class="card-desc">You've been showing up for each other every single day. Keep the flame alive!</div>
      <div class="card-action">View history <svg width="14" height="14" viewBox="0 0 14 14" fill="none"><path d="M3 7h8M8 4l3 3-3 3" stroke="#e8647a" stroke-width="1.5" stroke-linecap="round"/></svg></div>
    </div>

  </div>
</div>

<!-- ‚îÄ‚îÄ MODAL ‚îÄ‚îÄ -->
<div class="modal-overlay" id="modalOverlay" onclick="closeModalOutside(event)">
  <div class="modal" id="modalBox">
    <button class="modal-close" onclick="closeModal()">‚úï</button>
    <div id="modalContent"></div>
  </div>
</div>

<script>
  // ‚îÄ‚îÄ Load names ‚îÄ‚îÄ
  const uName = localStorage.getItem('userName')    || '';
  const pName = localStorage.getItem('partnerName') || '';

  document.getElementById('userName').textContent          = uName || 'there';
  document.getElementById('partnerNameDisplay').textContent = pName || 'your partner';
  document.getElementById('myAvatarName').textContent      = uName || 'You';
  document.getElementById('partnerAvatarName').textContent = pName || 'Partner';

  // Pre-fill the input fields
  document.getElementById('inputUserName').value    = uName;
  document.getElementById('inputPartnerName').value = pName;

  // ‚îÄ‚îÄ Live update names as user types ‚îÄ‚îÄ
  function updateNames() {
    const u = document.getElementById('inputUserName').value.trim();
    const p = document.getElementById('inputPartnerName').value.trim();

    localStorage.setItem('userName',    u);
    localStorage.setItem('partnerName', p);

    document.getElementById('userName').textContent          = u || 'there';
    document.getElementById('partnerNameDisplay').textContent = p || 'your partner';
    document.getElementById('myAvatarName').textContent      = u || 'You';
    document.getElementById('partnerAvatarName').textContent = p || 'Partner';
  }

  // ‚îÄ‚îÄ Load saved photos ‚îÄ‚îÄ
  const savedProfile = localStorage.getItem('profilePhoto');
  if (savedProfile) applyProfilePhoto(savedProfile);

  const savedCouple = localStorage.getItem('couplePhoto');
  if (savedCouple) applyCouplePhoto(savedCouple);

  // ‚îÄ‚îÄ Profile photo ‚îÄ‚îÄ
  function uploadProfilePhoto(e) {
    const file = e.target.files[0];
    if (!file) return;
    const reader = new FileReader();
    reader.onload = (ev) => {
      localStorage.setItem('profilePhoto', ev.target.result);
      applyProfilePhoto(ev.target.result);
    };
    reader.readAsDataURL(file);
  }

  function applyProfilePhoto(src) {
    const img   = document.getElementById('myAvatarImg');
    const emoji = document.getElementById('myAvatarEmoji');
    img.src = src;
    img.style.display = 'block';
    emoji.style.display = 'none';
  }

  // ‚îÄ‚îÄ Couple photo ‚îÄ‚îÄ
  function uploadCouplePhoto(e) {
    const file = e.target.files[0];
    if (!file) return;
    const reader = new FileReader();
    reader.onload = (ev) => {
      localStorage.setItem('couplePhoto', ev.target.result);
      applyCouplePhoto(ev.target.result);
    };
    reader.readAsDataURL(file);
  }

  function applyCouplePhoto(src) {
    const bg  = document.getElementById('coupleBg');
    const btn = document.getElementById('coupleBtn');
    bg.style.backgroundImage = `url('${src}')`;
    bg.classList.add('loaded');
    btn.innerHTML = 'üì∑ Change couple photo';
  }

  // ‚îÄ‚îÄ Mood ‚îÄ‚îÄ
  function setMood(btn, label) {
    document.querySelectorAll('.mood-btn').forEach(b => b.classList.remove('active'));
    btn.classList.add('active');
    const p = localStorage.getItem('partnerName') || 'your partner';
    const msgs = {
      'Happy':       `That's wonderful! Sharing this with ${p} will make them smile too üå∏`,
      'Loved up':    `Aww, go send ${p} a message! They'd love to hear that right now üíï`,
      'Missing you': `Distance is hard. Maybe schedule a call soon? You've got this ü§ç`,
      'Stressed':    `Take a breath. Talking to ${p} might help lighten the load üíõ`,
      'Excited':     `That energy is contagious! Tell ${p} all about it üéâ`
    };
    document.getElementById('moodResult').textContent = msgs[label] || '';
  }

  // ‚îÄ‚îÄ Modals ‚îÄ‚îÄ
  const modals = {
    video: {
      title: 'üìπ Video Call',
      get html() {
        const p = localStorage.getItem('partnerName') || 'your partner';
        return `<p>Start an instant video call with ${p}. No downloads needed ‚Äî just click and connect.</p>
          <button class="modal-btn" onclick="alert('Calling ${p}... üíï')">Start Video Call</button>`;
      }
    },
    questions: {
      title: 'üí¨ Question of the Moment',
      get html() {
        const qs = [
          "If you could teleport to me right now, what's the first thing you'd do?",
          "What's a small thing I do that makes you feel most loved?",
          "Describe our future home in three words.",
          "What song reminds you of us the most ‚Äî and why?",
          "What's a dream trip you want us to take together someday?",
          "What was the exact moment you knew I was special to you?",
          "If we could spend a whole day together doing anything, what would it be?",
          "What's something you've never told me but want me to know?"
        ];
        const q = qs[Math.floor(Math.random()*qs.length)];
        return `<div class="q-box" id="qBox">"${q}"</div>
          <button class="modal-btn" onclick="shuffleQ()">‚ú® Next question</button>`;
      }
    },
    games: {
      title: 'üéÆ Play Together',
      html: `<div class="game-list">
        <div class="game-item" onclick="alert('Loading Would You Rather...')">ü§î Would You Rather</div>
        <div class="game-item" onclick="alert('Loading Trivia for Two...')">üß† Trivia for Two</div>
        <div class="game-item" onclick="alert('Loading Guess the Memory...')">üì∏ Guess the Memory</div>
        <div class="game-item" onclick="alert('Loading 20 Questions...')">üí° 20 Questions</div>
      </div>
      <p style="font-size:0.8rem;color:var(--muted)">More games coming soon!</p>`
    },
    music: {
      title: 'üéµ Listening Together',
      get html() {
        const p = localStorage.getItem('partnerName') || 'your partner';
        return `
        <style>
          .playlist { list-style:none; margin-bottom:16px; display:flex; flex-direction:column; gap:6px; max-height:200px; overflow-y:auto; }
          .pl-item {
            display:flex; align-items:center; gap:10px;
            padding:10px 12px; border-radius:12px; cursor:pointer;
            transition:background 0.2s; font-size:0.88rem;
          }
          .pl-item:hover { background: var(--blush); }
          .pl-item.active { background: var(--rose); color:#fff; }
          .pl-item.active .pl-artist { color:rgba(255,255,255,0.75); }
          .pl-num { font-size:0.75rem; color:var(--muted); width:16px; text-align:center; flex-shrink:0; }
          .pl-item.active .pl-num { color:rgba(255,255,255,0.7); }
          .pl-info { flex:1; }
          .pl-title { font-weight:500; line-height:1.2; }
          .pl-artist { font-size:0.78rem; color:var(--muted); }
          .pl-dur { font-size:0.75rem; color:var(--muted); flex-shrink:0; }
          .pl-item.active .pl-dur { color:rgba(255,255,255,0.7); }
          .now-playing-bar {
            background: var(--deep); border-radius:16px;
            padding:16px 18px; color:#fff; margin-bottom:14px;
          }
          .np-top { display:flex; align-items:center; gap:12px; margin-bottom:12px; }
          .np-art {
            width:48px; height:48px; border-radius:10px;
            background: var(--rose); display:grid; place-items:center;
            font-size:1.4rem; flex-shrink:0;
          }
          .np-song { font-family:'Playfair Display',serif; font-size:1rem; line-height:1.2; }
          .np-artist { font-size:0.78rem; opacity:0.65; margin-top:2px; }
          .np-progress { width:100%; height:3px; background:rgba(255,255,255,0.2); border-radius:2px; margin-bottom:12px; cursor:pointer; }
          .np-fill { height:100%; background:var(--rose); border-radius:2px; transition:width 0.5s linear; }
          .np-times { display:flex; justify-content:space-between; font-size:0.72rem; opacity:0.55; margin-top:-8px; margin-bottom:10px; }
          .np-controls { display:flex; justify-content:center; align-items:center; gap:18px; }
          .np-btn { background:none; border:none; color:#fff; font-size:1.4rem; cursor:pointer; transition:transform 0.15s; padding:0; line-height:1; }
          .np-btn:hover { transform:scale(1.2); }
          .np-btn.play { font-size:1.8rem; }
          .sync-note { font-size:0.82rem; color:var(--muted); text-align:center; }
          .sync-note span { color:var(--rose); font-weight:500; }
        </style>

        <div class="now-playing-bar">
          <div class="np-top">
            <div class="np-art" id="npArt">üéµ</div>
            <div>
              <div class="np-song" id="npSong">A Thousand Miles</div>
              <div class="np-artist" id="npArtist">Vanessa Carlton</div>
            </div>
          </div>
          <div class="np-progress" onclick="seekSong(event,this)">
            <div class="np-fill" id="npFill" style="width:0%"></div>
          </div>
          <div class="np-times">
            <span id="npCurrent">0:00</span>
            <span id="npDuration">3:58</span>
          </div>
          <div class="np-controls">
            <button class="np-btn" onclick="prevSong()">‚èÆ</button>
            <button class="np-btn play" id="playBtn" onclick="togglePlay()">‚ñ∂Ô∏è</button>
            <button class="np-btn" onclick="nextSong()">‚è≠</button>
          </div>
        </div>

        <ul class="playlist" id="playlist">
          <li class="pl-item active" onclick="selectSong(0)">
            <span class="pl-num">‚ñ∂</span>
            <div class="pl-info"><div class="pl-title">A Thousand Miles</div><div class="pl-artist">Vanessa Carlton</div></div>
            <span class="pl-dur">3:58</span>
          </li>
          <li class="pl-item" onclick="selectSong(1)">
            <span class="pl-num">2</span>
            <div class="pl-info"><div class="pl-title">Perfect</div><div class="pl-artist">Ed Sheeran</div></div>
            <span class="pl-dur">4:23</span>
          </li>
          <li class="pl-item" onclick="selectSong(2)">
            <span class="pl-num">3</span>
            <div class="pl-info"><div class="pl-title">Can't Help Falling in Love</div><div class="pl-artist">Elvis Presley</div></div>
            <span class="pl-dur">3:00</span>
          </li>
          <li class="pl-item" onclick="selectSong(3)">
            <span class="pl-num">4</span>
            <div class="pl-info"><div class="pl-title">Lover</div><div class="pl-artist">Taylor Swift</div></div>
            <span class="pl-dur">3:41</span>
          </li>
          <li class="pl-item" onclick="selectSong(4)">
            <span class="pl-num">5</span>
            <div class="pl-info"><div class="pl-title">All of Me</div><div class="pl-artist">John Legend</div></div>
            <span class="pl-dur">4:29</span>
          </li>
          <li class="pl-item" onclick="selectSong(5)">
            <span class="pl-num">6</span>
            <div class="pl-info"><div class="pl-title">Make You Feel My Love</div><div class="pl-artist">Adele</div></div>
            <span class="pl-dur">3:32</span>
          </li>
          <li class="pl-item" onclick="selectSong(6)">
            <span class="pl-num">7</span>
            <div class="pl-info"><div class="pl-title">Thinking Out Loud</div><div class="pl-artist">Ed Sheeran</div></div>
            <span class="pl-dur">4:41</span>
          </li>
          <li class="pl-item" onclick="selectSong(7)">
            <span class="pl-num">8</span>
            <div class="pl-info"><div class="pl-title">Lucky</div><div class="pl-artist">Jason Mraz ft. Colbie Caillat</div></div>
            <span class="pl-dur">3:07</span>
          </li>
        </ul>

        <p class="sync-note">üéß You & <span>${p}</span> are listening together üíï</p>

        <script>
          const songs = [
            { title:"A Thousand Miles",       artist:"Vanessa Carlton",              emoji:"üéπ", dur:"3:58", secs:238 },
            { title:"Perfect",                artist:"Ed Sheeran",                   emoji:"üíõ", dur:"4:23", secs:263 },
            { title:"Can't Help Falling in Love", artist:"Elvis Presley",            emoji:"üåπ", dur:"3:00", secs:180 },
            { title:"Lover",                  artist:"Taylor Swift",                 emoji:"üíû", dur:"3:41", secs:221 },
            { title:"All of Me",              artist:"John Legend",                  emoji:"üé∂", dur:"4:29", secs:269 },
            { title:"Make You Feel My Love",  artist:"Adele",                        emoji:"üïØÔ∏è", dur:"3:32", secs:212 },
            { title:"Thinking Out Loud",      artist:"Ed Sheeran",                   emoji:"üåÖ", dur:"4:41", secs:281 },
            { title:"Lucky",                  artist:"Jason Mraz ft. Colbie Caillat",emoji:"üçÄ", dur:"3:07", secs:187 },
          ];
          let curIdx = 0, playing = false, elapsed = 0, timer = null;

          function selectSong(i) {
            curIdx = i; elapsed = 0; clearInterval(timer);
            playing = false;
            document.querySelectorAll('.pl-item').forEach((el,j) => {
              el.classList.toggle('active', j===i);
              el.querySelector('.pl-num').textContent = j===i ? '‚ñ∂' : (j+1);
            });
            const s = songs[i];
            document.getElementById('npSong').textContent   = s.title;
            document.getElementById('npArtist').textContent = s.artist;
            document.getElementById('npArt').textContent    = s.emoji;
            document.getElementById('npDuration').textContent = s.dur;
            document.getElementById('npFill').style.width   = '0%';
            document.getElementById('npCurrent').textContent = '0:00';
            document.getElementById('playBtn').textContent  = '‚ñ∂Ô∏è';
          }

          function togglePlay() {
            playing = !playing;
            document.getElementById('playBtn').textContent = playing ? '‚è∏' : '‚ñ∂Ô∏è';
            if (playing) {
              timer = setInterval(() => {
                elapsed++;
                const total = songs[curIdx].secs;
                if (elapsed >= total) { nextSong(); return; }
                document.getElementById('npFill').style.width = (elapsed/total*100) + '%';
                const m = Math.floor(elapsed/60), s = elapsed%60;
                document.getElementById('npCurrent').textContent = m+':'+(s<10?'0':'')+s;
              }, 1000);
            } else {
              clearInterval(timer);
            }
          }

          function nextSong() { selectSong((curIdx+1) % songs.length); }
          function prevSong() { selectSong((curIdx-1+songs.length) % songs.length); }

          function seekSong(e, bar) {
            const rect = bar.getBoundingClientRect();
            const pct  = (e.clientX - rect.left) / rect.width;
            elapsed = Math.floor(pct * songs[curIdx].secs);
            document.getElementById('npFill').style.width = (pct*100)+'%';
            const m = Math.floor(elapsed/60), s = elapsed%60;
            document.getElementById('npCurrent').textContent = m+':'+(s<10?'0':'')+s;
          }
        <\/script>`;
      }
    },
    streak: {
      title: 'üî• Your Streak',
      get html() {
        const total = 14;
        const p = localStorage.getItem('partnerName') || 'your partner';
        let dots = '';
        for(let i=0;i<21;i++) dots += `<div class="dot ${i<total?'filled':''}"></div>`;
        return `<p>You and ${p} have checked in together <strong>${total} days in a row</strong>. Amazing!</p>
          <div class="streak-dots">${dots}</div>
          <p style="font-size:0.8rem;color:var(--muted);margin-top:14px;margin-bottom:0">Each dot = one day together üå∏</p>`;
      }
    }
  };

  function openModal(key) {
    const m = modals[key];
    document.getElementById('modalContent').innerHTML = `<h2>${m.title}</h2>${m.html}`;
    document.getElementById('modalOverlay').classList.add('open');
  }
  function closeModal() { document.getElementById('modalOverlay').classList.remove('open'); }
  function closeModalOutside(e) { if(e.target===document.getElementById('modalOverlay')) closeModal(); }

  function shuffleQ() {
    const qs = [
      "If you could teleport to me right now, what's the first thing you'd do?",
      "What's a small thing I do that makes you feel most loved?",
      "Describe our future home in three words.",
      "What song reminds you of us the most ‚Äî and why?",
      "What's a dream trip you want us to take together someday?",
      "What was the exact moment you knew I was special to you?",
      "If we could spend a whole day together doing anything, what would it be?",
      "What's something you've never told me but want me to know?"
    ];
    const box = document.getElementById('qBox');
    box.style.opacity = 0;
    setTimeout(() => { box.textContent = `"${qs[Math.floor(Math.random()*qs.length)]}"`;  box.style.opacity = 1; }, 250);
  }
</script>
</body>
</html>